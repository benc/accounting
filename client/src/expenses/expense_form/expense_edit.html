<h2 *ngIf="isNew()" class="sub-header">Create a new expense</h2>
<h2 *ngIf="!isNew()" class="sub-header">Edit expense</h2>

<form [formGroup]="expenseForm" (ngSubmit)="saveOrUpdate(expenseForm.value)" class="ui form">

  <div class="field" [class.error]="!expenseForm.controls.name.valid && expenseForm.controls.name.touched"np>
    <label for="nameInput">Name:</label>
    <input type="text" id="nameInput" placeholder="Name" formControlName="name">
    <div *ngIf="!expenseForm.controls.name.valid" class="ui error message">Name is invalid</div>
    <div *ngIf="expenseForm.controls.name.hasError('required')" class="ui error message">Name is required</div>
  </div>

  <div class="three fields">

    <div class="field"  [class.error]="!expenseForm.controls.amount.valid && expenseForm.controls.amount.touched">
      <label for="amountInput">Amount:</label>
      <input type="text" id="amountInput" placeholder="Amount" formControlName="amount">
      <div *ngIf="!expenseForm.controls.amount.valid" class="ui error message">Invalid amount</div>
      <div *ngIf="expenseForm.controls.amount.hasError('required')" class="ui error message">Amount is required</div>
    </div>

    <div class="field" [class.error]="!expenseForm.controls.currency.valid && expenseForm.controls.currency.touched">
      <label for="currencyInput">Currency:</label>
      <select class="ui dropdown" id="currencyInput" formControlName="currency" placeholder="Currency">
        <option *ngFor="let currency of currencies" [value]="currency">{{ currency }}</option>
      </select>
      <div *ngIf="!expenseForm.controls.currency.valid" class="ui error message">Invalid currency</div>
      <div *ngIf="expenseForm.controls.currency.hasError('required')" class="ui error message">Currency is required</div>
    </div>

    <div class="field" [class.error]="!expenseForm.controls.vat.valid && expenseForm.controls.vat.touched">
    <label for="vatInput">VAT:</label>
      <select class="ui dropdown" id="vatInput" formControlName="vat" placeholder="VAT">
        <option *ngFor="let vatRate of vatRates" [value]="vatRate">{{ vatRate }}</option>
      </select>
      <div *ngIf="!expenseForm.controls.vat.valid" class="ui error message">Invalid VAT</div>
      <div *ngIf="expenseForm.controls.vat.hasError('required')" class="ui error message">VAT is required</div>
    </div>

  </div>

  <div class="two fields">

    <div class="field" [class.error]="!expenseForm.controls.invoiceDate.valid && expenseForm.controls.invoiceDate.touched">
      <label for="invoiceDateInput">Invoice date:</label>
      <input type="date" id="invoiceDateInput" placeholder="Invoice date" formControlName="invoiceDate">
      <div *ngIf="!expenseForm.controls.invoiceDate.valid" class="ui error message">Invalid invoice date</div>
      <div *ngIf="expenseForm.controls.invoiceDate.hasError('required')" class="ui error message">Invoice date is required</div>
    </div>

    <div class="field" [class.error]="!expenseForm.controls.paymentDate.valid && expenseForm.controls.paymentDate.touched">
      <label for="paymentDateInput">Payment date:</label>
      <input type="date" id="paymentDateInput" placeholder="Payment date" formControlName="paymentDate">
      <div *ngIf="!expenseForm.controls.paymentDate.valid" class="ui error message">Invalid payment date</div>
      <div *ngIf="expenseForm.controls.paymentDate.hasError('required')" class="ui error message">Payment date is required</div>
    </div>

  </div>

  <div class="two fields">

    <div class="twelve wide field" [class.error]="!expenseForm.controls.category.valid && expenseForm.controls.category.touched">
      <label for="categoryInput">Category:</label>
      <input type="text" id="categoryInput" placeholder="Category" formControlName="category">
      <div *ngIf="!expenseForm.controls.category.valid" class="ui error message">Invalid category</div>
      <div *ngIf="expenseForm.controls.category.hasError('required')" class="ui error message">Category is required</div>
    </div>

    <div class="four wide field" [class.error]="!expenseForm.controls.indexNumber.valid && expenseForm.controls.indexNumber.touched">
      <label for="indexNumberInput">Index number:</label>
      <input type="text" id="indexNumberInput" placeholder="Index number" formControlName="indexNumber">
      <div *ngIf="!expenseForm.controls.indexNumber.valid" class="ui error message">Invalid index number</div>
      <div *ngIf="expenseForm.controls.indexNumber.hasError('required')" class="ui error message">Index number is required</div>
    </div>

  </div>

  <div class="field" [class.error]="!expenseForm.controls.remark.valid && expenseForm.controls.remark.touched">
    <label for="remarkInput">Remark:</label>
    <textarea id="remarkInput" placeholder="Remark" formControlName="remark"></textarea>
    <div *ngIf="!expenseForm.controls.remark.valid" class="ui error message">Invalid remark</div>
    <div *ngIf="expenseForm.controls.remark.hasError('required')" class="ui error message">Remark is required</div>
  </div>

  <div class="ui buttons">
    <button (click)="cancel()" class="ui button">Cancel</button>
    <div class="or"></div>
    <button [disabled]="!expenseForm.valid" type="submit" class="ui positive button">
      <span *ngIf="isNew()">Create</span>
      <span *ngIf="!isNew()">Update</span>
    </button>
  </div>

</form>
